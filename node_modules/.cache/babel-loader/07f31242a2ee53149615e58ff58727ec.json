{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pranay.j/giphy-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/Users/pranay.j/giphy-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/pranay.j/giphy-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/pranay.j/giphy-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useCallback,useRef}from'react';import SearchGif from'./components/SearchGif/SearchGif';import ToggleTheme from'./components/ToggleTheme/ToggleTheme';import GifContainer from'./components/GifContainer/GifContainer';import LoadingGif from'./components/LoadingGif/LoadingGif';import ThemeContext from'./common/ThemeContext';import axios from'axios';import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){console.log(\"in app.js \");var _useState=useState([]),_useState2=_slicedToArray(_useState,2),gifData=_useState2[0],setGifData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchQuery=_useState4[0],setSearchQuery=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),darkTheme=_useState6[0],setDarkTheme=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var isTrue=useRef(true);var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),pageNumber=_useState10[0],setPageNumber=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),triggerIntersectionObserver=_useState12[0],setTriggerIntersectionObserver=_useState12[1];var loader=useRef(null);/***\n   * Netlify function gets called from here.\n   */function getGifs(_x){return _getGifs.apply(this,arguments);}// Intersection Observer\nfunction _getGifs(){_getGifs=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(offset){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);if(!searchQuery){_context.next=7;break;}_context.next=4;return axios.get(\"/.netlify/functions/get_search_gifs?q=\".concat(searchQuery,\"&offset=\").concat(offset));case 4:_context.t0=_context.sent;_context.next=10;break;case 7:_context.next=9;return axios.get(\"/.netlify/functions/get_trending_gifs?offset=\".concat(offset));case 9:_context.t0=_context.sent;case 10:response=_context.t0;if(response.data.response){setGifData(function(prev){return[].concat(_toConsumableArray(prev),_toConsumableArray(response.data.response.data));});setLoading(false);}case 12:case\"end\":return _context.stop();}}},_callee);}));return _getGifs.apply(this,arguments);}var handleObserver=useCallback(function(entries){var _entries=_slicedToArray(entries,1),target=_entries[0];if(isTrue.current){isTrue.current=false;return;}if(target.isIntersecting&&Math.floor(target.intersectionRatio)===1){setPageNumber(function(prev){return prev+20;});setTriggerIntersectionObserver(function(prev){return!prev;});}},[]);useEffect(function(){getGifs(pageNumber);},[triggerIntersectionObserver]);useEffect(function(){setGifData([]);setPageNumber(0);},[searchQuery]);useEffect(function(){var option={root:null,rootMargin:\"10px\",threshold:0};var observer=new IntersectionObserver(handleObserver,option);if(loader.current)observer.observe(loader.current);return function(){if(loader.current){observer.unobserve(loader.current);}};},[]);var toggleTheme=function toggleTheme(){setDarkTheme(!darkTheme);};return/*#__PURE__*/_jsx(ThemeContext.Provider,{value:{darkTheme:darkTheme},children:/*#__PURE__*/_jsxs(\"div\",{className:\"App px-10 right-align \".concat(darkTheme?'dark':'light'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sticky container-fluid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"row pb-3 \".concat(darkTheme?'dark':'light'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"col-lg-4 col-md-4 col-sm-12 center-align mt-3 \".concat(darkTheme?'darkTitle':'lightTitle'),children:\"Giphy Infinite Scroll\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-lg-8 col-md-8 col-sm-12 right-align center-align mt-3\",children:[/*#__PURE__*/_jsx(SearchGif,{setSearchQuery:setSearchQuery}),/*#__PURE__*/_jsx(ToggleTheme,{toggleTheme:toggleTheme})]})]}),/*#__PURE__*/_jsx(\"div\",{children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"grad1\"}):/*#__PURE__*/_jsx(\"hr\",{className:\"\".concat(darkTheme?'darkLine':'lightLine')})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(darkTheme?'darkDiv':'lightDiv')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-around my-2 py-2 px-10\",children:/*#__PURE__*/_jsx(GifContainer,{gifData:gifData})}),/*#__PURE__*/_jsx(\"div\",{ref:loader,children:loading?/*#__PURE__*/_jsx(LoadingGif,{darkTheme:darkTheme}):/*#__PURE__*/_jsx(_Fragment,{})})]})});}export default App;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useRef","SearchGif","ToggleTheme","GifContainer","LoadingGif","ThemeContext","axios","App","console","log","gifData","setGifData","searchQuery","setSearchQuery","darkTheme","setDarkTheme","loading","setLoading","isTrue","pageNumber","setPageNumber","triggerIntersectionObserver","setTriggerIntersectionObserver","loader","getGifs","offset","get","response","data","prev","handleObserver","entries","target","current","isIntersecting","Math","floor","intersectionRatio","option","root","rootMargin","threshold","observer","IntersectionObserver","observe","unobserve","toggleTheme"],"sources":["/Users/pranay.j/giphy-app/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport SearchGif from './components/SearchGif/SearchGif';\nimport ToggleTheme from './components/ToggleTheme/ToggleTheme';\nimport GifContainer from './components/GifContainer/GifContainer';\nimport LoadingGif from './components/LoadingGif/LoadingGif';\nimport ThemeContext from './common/ThemeContext';\nimport axios from 'axios';\nimport './App.css';\n\nfunction App() {\n  console.log(\"in app.js \")\n  const [gifData, setGifData] = useState([]);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [darkTheme, setDarkTheme] = useState(true);\n  const [loading, setLoading] = useState(true);\n  const isTrue = useRef(true);\n  const [pageNumber, setPageNumber] = useState(0);\n  const [triggerIntersectionObserver, setTriggerIntersectionObserver] = useState(false);\n  const loader = useRef(null);\n\n  /***\n   * Netlify function gets called from here.\n   */\n  async function getGifs(offset) {\n    setLoading(true)\n    const response = searchQuery ? await axios.get(`/.netlify/functions/get_search_gifs?q=${searchQuery}&offset=${offset}`) : await axios.get(`/.netlify/functions/get_trending_gifs?offset=${offset}`)\n    if(response.data.response) {\n      setGifData(prev => {\n        return [...prev, ...response.data.response.data]\n      })\n      setLoading(false)\n    }\n  }\n\n  // Intersection Observer\n  const handleObserver = useCallback((entries) => {\n    const [target] = entries;\n    if(isTrue.current) {\n      isTrue.current = false;\n      return;\n    }\n    if (target.isIntersecting && Math.floor(target.intersectionRatio) === 1) {\n      setPageNumber(prev => prev + 20);\n      setTriggerIntersectionObserver(prev => !prev);\n    }\n  }, []);\n\n  useEffect(() => {\n    getGifs(pageNumber)\n  }, [triggerIntersectionObserver])\n\n  useEffect(() => {\n    setGifData([]);\n    setPageNumber(0);\n}, [searchQuery]);\n\n  useEffect(() => {\n    const option = {\n      root: null,\n      rootMargin: \"10px\",\n      threshold: 0\n    };\n    const observer = new IntersectionObserver(handleObserver, option);\n    if (loader.current) observer.observe(loader.current);\n    \n    return () => {\n      if (loader.current) {\n          observer.unobserve(loader.current);\n      }\n    }\n  }, []);\n  \n  const toggleTheme = () => {\n    setDarkTheme(!darkTheme);\n  }\n\n  return (\n    <ThemeContext.Provider value={{darkTheme: darkTheme}}>\n      <div className={`App px-10 right-align ${darkTheme ? 'dark' : 'light'}`}>\n        <div className=\"sticky container-fluid\">\n          <div className={`row pb-3 ${darkTheme ? 'dark' : 'light'}`}>\n            <span className={`col-lg-4 col-md-4 col-sm-12 center-align mt-3 ${darkTheme ? 'darkTitle' : 'lightTitle'}`}>Giphy Infinite Scroll</span>\n            <div className=\"col-lg-8 col-md-8 col-sm-12 right-align center-align mt-3\">\n              <SearchGif setSearchQuery={setSearchQuery}/>\n              <ToggleTheme toggleTheme={toggleTheme}/>\n            </div>\n          </div>\n          <div>\n            {\n              loading ? <div className=\"grad1\"></div> : <hr className={`${darkTheme ? 'darkLine' : 'lightLine'}`}></hr>\n            }\n          </div>\n        </div>\n        <div className={`${darkTheme ? 'darkDiv' : 'lightDiv'}`}></div>\n        <div className='space-around my-2 py-2 px-10'>\n          <GifContainer gifData={gifData} />\n        </div>\n        <div ref={loader}>\n          {\n              loading ? <LoadingGif  darkTheme={darkTheme}/> : <></>\n          }\n        </div>\n      </div>\n    </ThemeContext.Provider>\n  );\n}\nexport default App;"],"mappings":"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"},"metadata":{},"sourceType":"module"}